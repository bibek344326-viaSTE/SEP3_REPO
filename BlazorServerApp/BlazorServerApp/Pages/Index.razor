@page "/"
@using BlazorServerApp.Infrastructure.Repositories


<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app.

<SurveyPrompt Title="How is Blazor working for you?" />

<h2>Login</h2>
<EditForm Model="@loginModel" OnValidSubmit="HandleLogin">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div>
        <label for="username">Username:</label>
        <InputText id="username" @bind-Value="loginModel.Username" />
    </div>

    <div>
        <label for="password">Password:</label>
        <InputText id="password" type="password" @bind-Value="loginModel.Password" />
    </div>

    <button type="submit">Login</button>
</EditForm>

<p>@loginMessage</p>

<h2>Register</h2>
<EditForm Model="@registerModel" OnValidSubmit="HandleRegister">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div>
        <label for="regUsername">Username:</label>
        <InputText id="regUsername" @bind-Value="registerModel.Username" />
    </div>

    <div>
        <label for="regPassword">Password:</label>
        <InputText id="regPassword" type="password" @bind-Value="registerModel.Password" />
    </div>

    <div>
        <label for="regRole">Role:</label>
        <InputText id="regRole" @bind-Value="registerModel.Role" />
    </div>

    <button type="submit">Register</button>
</EditForm>

<p>@registerMessage</p>

@code {
    private LoginModel loginModel = new LoginModel();
    private RegisterModel registerModel = new RegisterModel();
    private string loginMessage;
    private string registerMessage;

    [Inject]
    private AuthRepository AuthRepository { get; set; }

    private async Task HandleLogin()
    {
        loginMessage = "Logging in...";
    }

    private async Task HandleRegister()
    {
        registerMessage = "Registering user...";
    }

    public class LoginModel
    {
        public string Username { get; set; } = string.Empty;
        public string Password { get; set; } = string.Empty;
    }

    public class RegisterModel
    {
        public string Username { get; set; } = string.Empty;
        public string Password { get; set; } = string.Empty; // Fixed typo
        public string Role { get; set; } = string.Empty; // Added Role property
    }
}
